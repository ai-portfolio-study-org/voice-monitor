FROM grafana/grafana:latest

# 환경 변수 설정
ENV GF_SECURITY_ADMIN_USER=admin
ENV GF_SECURITY_ADMIN_PASSWORD=admin
ENV GF_AUTH_ANONYMOUS_ENABLED=true
ENV GF_AUTH_ANONYMOUS_ORG_ROLE=Admin
ENV GF_AUTH_BASIC_ENABLED=false
ENV GF_SECURITY_ALLOW_EMBEDDING=true
ENV GF_SECURITY_COOKIE_SAMESITE=none
ENV GF_SECURITY_COOKIE_SECURE=true
ENV GF_SECURITY_DISABLE_GRAVATAR=true
ENV GF_SECURITY_DISABLE_BRUTE_FORCE_LOGIN_PROTECTION=true
ENV GF_SECURITY_X_FRAME_OPTIONS=
ENV GF_SECURITY_CONTENT_SECURITY_POLICY=false
ENV GF_SECURITY_STRICT_TRANSPORT_SECURITY=false
ENV GF_SECURITY_ALLOW_EMBEDDING_FROM_ANYWHERE=true

# grafana.ini 설정 파일 복사
COPY grafana.ini /etc/grafana/grafana.ini

# 대시보드와 데이터소스 프로비저닝 설정 복사
COPY provisioning /etc/grafana/provisioning
COPY dashboards /var/lib/grafana/dashboards 